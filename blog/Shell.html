<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>blog.elizib.in</title>
    <meta name="description" content="Eli Zibin is a web developer in Vancouver BC">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Open Graph: Facebook -->
    <meta property="og:title" content="Eli Zibin ~ Web Developer">
    <meta property="og:url" content="http://elizib.in">
    <meta property="og:description" content="Eli Zibin is a web developer in Vancouver, BC.">
    <!-- Twitter Cards-->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:site" content="@elizibin">
    <meta property="twitter:title" content="Eli Zibin ~ Web Developer">
    <meta property="twitter:description" content="Eli Zibin is a web developer in Vancouver, BC.">
    <meta property="twitter:domain" content="http://elizib.in">
    <link rel="shortcut icon" href="../img/favicon.ico?v=2" />
    <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../css/main.min.css">
    <script src="../js/vendor/modernizr-2.8.3.min.js"></script>
    <script>
        document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
    </script>
</head>

<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <main class="bloghome container">
        <header class="row">
          <section class="text-center">
            <h1><a href="../index">{{ eli-zibin }}</a></h1>
            <h3><span class="up">select</span> *
                  <span class="up">from</span> <span class="flourish"><a href="all.html">blog posts</a></span>
                <span class="up">where</span> name = <span class="flourish">'Shell'</span>;
            </h3>
            </section>
        </header>

        <article class="row">
          <section class="blog-content col-md-8 col-md-offset-2">
            <p>In a nutshell, Shell is a program that passes commands entered on the keyboard to the computer's operating system - a.k.a The Kernel - to execute. The metaphors are specific. I access the "shell" of the "kernel" in order to execute commands. The shell is often known as a <em>command line interface</em>, CLI. In addition to the Unix CLI, it's also possible to write shell scripts which execute programs. A shell script is a file that executes a series of commands which the shell then executes.</p>
            <p>The canonical example "my first shell script" resembles something like: </p>
            <pre class="code-snippet">
                <code class="language-bash">
    #!/bin/bash
    # hello_world.sh
    # My first script

    echo "Hello World!
                </code></pre>
            <p>After modifying the appropriate permissions on the file it becomes possible to execute this command in the shell. Permissions are important when it comes to allowing which users can do what where on a computer. In Mac OSX, for example, we usually have to use the sudo command if we are modifying anything outside of the home directory. Access and privilege seem to major concepts in the design of any operating system. The three major permissions in question here are "read", "write", and "execute". We can view which permissions a file has using the ls -lha command: </p>
            <pre class="code-snippet">
                <code class="language-bash">
                  $ ls -lha
                  -rw-r--r--    1 elizibin  staff  68B 12 Jan 11:30 hello_world.sh
                </code>
              </pre>

            <p>Right now this file is only readable and writable, not executable. However, we can change the permissions of a file using the chmod command:</p>

            <pre class="code-snippet">
              <code class="language-bash">
                $ chmod a+x hello_world.sh
              </code>
            </pre>

            <p>This command edits the current permissions in order to make the shell script executable:</p>
            <pre class="code-snippet">
                <code class="language-bash">
                  $   ls -lha
                  =>  -rwxr--r--    1 elizibin  staff  68B 12 Jan 11:30 hello_world.sh
                </code></pre>
            <p>You can now see there is an <strong>x</strong> in the permissions section. </p>
            <p>Cool - except this script useless.</p>
            <p>I don't have much experience writing shell scripts, but two uses I've come across is using them with <a href="https://www.vagrantup.com/">Hashicorp's Vagrant</a> and initializing boilerplates for projects.</p>
            <p>In Vagrant we can use a shell script to provision the virtual machine so that we don't have to download and install everything by hand each time we spin up a box. The <a href="https://docs.vagrantup.com/v2/provisioning/file.html">Vagrant Docs</a> give some examples of how to point to the shell script from your Vagrant file. It can be done both inline in your Vagrant file, or it can point to a shell script in the root directory of your project. </p>
            <p>For example, to install a more recent version of ruby (hashicorp/precise32 comes with ruby version 1.87) we can write a shell script that downloads all our goodies for us: </p>
<pre class="code-snippet line-numbers">
<code class="language-bash">
  #!/usr/bin/env bash
  # provision.sh

# build essentials
echo "Building essentials..."
sudo apt-get update
sudo apt-get install -y build-essential git curl libxslt1-dev libxml2-dev libssl-dev htop pkg-config openjdk-7-jre-headless

# install RVM
echo "Installing RVM..."

    RUBY_VERSION="2.3.0"
    sudo apt-get -y update
    sudo apt-get -y install nodejs
    # Install ruby environment
    if ! type rvm >/dev/null 2>&1; then
      curl -sSL https://rvm.io/mpapis.asc | gpg --import -
      curl -L https://get.rvm.io | bash -s stable
      source /etc/profile.d/rvm.sh
    fi

    if ! rvm list rubies ruby | grep ruby-${RUBY_VERSION}; then
      rvm install ${RUBY_VERSION}
    fi

    rvm --default use ${RUBY_VERSION}

    gem install bundler
</code>
</pre>
            <p>After that a simple <strong>vagrant up</strong> will provision the machine with RVM using ruby 2.3.0 as its default. There's obviously other things that can be added here, like postgresql, and other dependencies - but I'm not totally sure how to configure all of that yet.</p>

            <p>The other basic use for shell scripts I've found is for boot-strapping basic Rails projects: </p>
<pre class="code-snippet line-numbers">
<code class="language-bash">
  #!/usr/bin/env bash
  APP_NAME=$1

  echo "App name is = " $APP_NAME

  cd ~/Desktop/rails
  echo "Initializing Rails App with postgresql..."
  rails new $APP_NAME -d=postgresql -m /Users/elizibin/Desktop/rails/templates/rails-template.rb
  cd /Users/elizibin/Desktop/rails/$APP_NAME
  echo "Bundling..."
  bundle install
  bundle exec rspec:install
  bundle exec rake db:create:migrate
  echo "add bootstrap"
  sed -i "15i //= require bootstrap" app/assets/javascripts/application.js
  echo "Initializing git repository..."
  git init
  git add .
  git commit -m  "initial commit"
  </code>
</pre>
            <p>As I keep most of my rails projects in a 'rails' directory, this shell script cd's into it and initializes a new rails app there using postgresql. I also pass the -m flag which is the r. It allows you to point to a rails application template which uses a DSL to add gems, run rake tasks, initializers etc as you start a new project. This one points to a rails-template.rb that looks like this: </p>
<pre class="code-snippet line-numbers">
<code class="language-ruby">
  # rails-template.rb

  # Use Bootstrap
  gem 'bootstrap-sass'
  # Friendly ID
  gem 'friendly_id', '~> 5.1.0'
  # ENVARS
  gem 'figaro'
  gem_group :development, :test do
    gem 'byebug'
    gem 'pry'
    # Use RSPEC for testing
    gem 'rspec-rails', '~> 3.0.0'
    # Factory Girl for Factories
    gem "factory_girl_rails", '~> 4.5.0'
  end
  gem_group :production do
    # PUMA web-server
    gem 'puma'
    # for heroku
    gem 'rails_12factor'
  end
</code>
</pre>
            <p>As you can see, I'm only using the gem features of the template DSL. But back to the shell script: I then cd's into the project's directory, bundle the gems, initialize rspec, create and migrate the database, add the bootstrap configuration to the javascript manifest file, and finishe by initializing a git repo and add/commiting what's been accomplished so far. </p>

            <p>This simple type of automation makes things just a slightly bit easier, cutting down on the amount of copy/pasting I have to do. It feels a bit arcane trying to learn bash so far, but what I have learned feels worthwhile. I want to start automating tiny little tasks like this more often. I wouldn't mind digging deeper into how exactly the shell and a kernal operate. Not entirely sure how these commands translate into making the computer do something. Lots to learn. </p>
          </section>
    </main>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="../js/vendor/jquery-1.11.3.min.js"><\/script>')
    </script>
    <script src="../js/main.min.js"></script>
    <script>
        (function(b, o, i, l, e, r) {
            b.GoogleAnalyticsObject = l;
            b[l] || (b[l] =
                function() {
                    (b[l].q = b[l].q || []).push(arguments)
                });
            b[l].l = +new Date;
            e = o.createElement(i);
            r = o.getElementsByTagName(i)[0];
            e.src = 'https://www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e, r)
        }(window, document, 'script', 'ga'));
        ga('create', 'UA-55771414-8', 'auto');
        ga('send', 'pageview');
    </script>
</body>

</html>
